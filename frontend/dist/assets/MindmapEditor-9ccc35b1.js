import{_ as ot,k as lt,u as at,a as nt,g as I,J as st,K as ke,o as it,L as rt,r as w,b as S,c as U,d as o,w as l,n,e as x,a5 as _,a6 as b,M as dt,f as $,m as z,z as E,a7 as Ie,x as ut,O as ct,P as ft,H as ce,I as fe,a8 as be,a9 as G,A as j,aa as mt,ab as Ce,ac as pt,ad as ht,ae as X,af as vt,ag as gt,ah as yt,E as m,h as xt}from"./index-911a223c.js";import{m as L}from"./editor-cbc213f0.js";import{A as _t}from"./AIModuleButton-5b08fb21.js";const wt={class:"mindmap-editor"},St={class:"editor-header"},Nt={class:"header-left"},kt={class:"header-right"},It={class:"operation-buttons"},bt={class:"mindmap-container"},Ct=["x1","y1","x2","y2"],Mt=["transform","onMousedown","onDblclick"],Ot=["width","height","fill","stroke"],Vt=["x","y","fill","font-size"],At={key:0,class:"node-edit-panel"},Jt={class:"edit-buttons"},Et={class:"style-buttons"},Dt={key:0,class:"editor-footer"},Rt={class:"save-status"},Ut={style:{display:"flex","align-items":"center",gap:"8px"}},zt=["href"],Lt={class:"version-item"},Pt={class:"version-content"},Tt={class:"version-actions"},$t=50,Bt={__name:"MindmapEditor",props:{isNew:{type:Boolean,default:!1},mindmapId:{type:Number,default:null},isShared:{type:Boolean,default:!1},sharePermission:{type:String,default:"view"},sharedMindmap:{type:Object,default:null}},setup(g){const Y=g,Me=lt(),me=at(),pe=Y.mindmapId||Me.params.id,Oe=nt(),y=I({id:null,title:(()=>`新脑图_${new Date().getTime()}`)(),data:{},is_public:!1}),v=I([{id:1,text:"中心主题",x:400,y:300,width:120,height:40,parentId:null}]),C=I([]),f=I(null),B=I(""),M=I({fontSize:14,fontColor:"#333",bgColor:"#fff"}),oe=I(null),le=I(null),H=I("未保存"),A=I(1),D=I([]),R=I(-1),ae=I(!1),P=I({permission:"view",expire_at:""}),ne=I([]),K=I(!1),se=st();ke(()=>se.hasNewContent,t=>{if(t)try{let e=se.generatedContent;if(console.log("AI生成的原始内容:",e),!e||e.trim()===""){m.error("AI服务未返回任何内容，请检查AI服务配置是否正确"),console.error("AI生成内容为空，可能的原因："),console.error("1. AI服务配置不正确（API密钥、基础URL等）"),console.error("2. 网络连接问题"),console.error("3. AI模型调用失败");return}let i=e;const c=e.match(/```json[\s\S]*?```/);if(c)console.log("找到JSON代码块:",c[0]),i=c[0].replace(/```json\s*/,"").replace(/\s*```/,"");else{const d=e.match(/```[\s\S]*?```/);if(d)console.log("找到普通代码块:",d[0]),i=d[0].replace(/```\s*/,"").replace(/\s*```/,"");else{console.log("未找到代码块，尝试直接处理内容");const u=e.indexOf("{"),r=e.lastIndexOf("}");u!==-1&&r!==-1&&(i=e.substring(u,r+1),console.log("提取到的JSON内容:",i))}}if(i=i.trim(),console.log("清理后的JSON内容:",i),!i){m.error("AI未生成有效的脑图数据，请检查AI服务的系统提示词是否正确");return}try{const d=JSON.parse(i);console.log("解析后的脑图数据:",d),d.nodes&&Array.isArray(d.nodes)&&d.edges&&Array.isArray(d.edges)?(v.value=d.nodes,C.value=d.edges,T=Math.max(...v.value.map(r=>r.id),1)+1,F(!0),m.success("AI生成的脑图已成功加载")):m.error("AI生成的脑图格式不正确")}catch(d){console.error("JSON解析失败:",d),console.error("原始JSON内容:",i);try{const u=i.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"");console.log("清理后的JSON内容:",u);const r=JSON.parse(u);if(console.log("修复后解析的脑图数据:",r),r.nodes&&Array.isArray(r.nodes)&&r.edges&&Array.isArray(r.edges)){v.value=r.nodes,C.value=r.edges,T=Math.max(...v.value.map(J=>J.id),1)+1,F(!0),m.success("AI生成的脑图已成功加载（已修复格式）");return}}catch(u){console.error("修复JSON格式失败:",u)}try{console.log("尝试从文本描述中生成脑图数据");const u=Ke(i);v.value=u.nodes,C.value=u.edges,T=Math.max(...v.value.map(r=>r.id),1)+1,console.log("保存前的数据:",{title:y.value.title||"新脑图",data:{nodes:JSON.parse(JSON.stringify(v.value)),edges:JSON.parse(JSON.stringify(C.value))},is_public:y.value.is_public}),F(!0),m.success("AI生成的脑图已成功加载（根据描述生成）");return}catch(u){console.error("从描述生成脑图失败:",u)}try{console.log("尝试生成默认脑图数据");const u={nodes:[{id:1,label:"主题",position:{x:400,y:100}},{id:2,label:"子主题1",position:{x:200,y:200}},{id:3,label:"子主题2",position:{x:600,y:200}}],edges:[{from:1,to:2},{from:1,to:3}]};v.value=u.nodes,C.value=u.edges,T=4,F(!0),m.success("AI生成的脑图格式有问题，已生成默认脑图结构");return}catch(u){console.error("生成默认脑图失败:",u)}m.error("解析AI生成的脑图失败，JSON格式不正确")}}catch(e){console.error("解析AI脑图数据失败:",e),m.error("解析AI生成的脑图失败")}finally{se.resetGeneratedContent()}});const he=I([]);let T=2,Q=!1,Z=null,ie={x:0,y:0};function Ve(){R.value<D.value.length-1&&(D.value=D.value.slice(0,R.value+1));const t={nodes:JSON.parse(JSON.stringify(v.value)),edges:JSON.parse(JSON.stringify(C.value))};D.value.push(t),D.value.length>$t?D.value.shift():R.value++}function Ae(){if(R.value>0){R.value--;const t=D.value[R.value];v.value=JSON.parse(JSON.stringify(t.nodes)),C.value=JSON.parse(JSON.stringify(t.edges)),V()}}function Je(){if(R.value<D.value.length-1){R.value++;const t=D.value[R.value];v.value=JSON.parse(JSON.stringify(t.nodes)),C.value=JSON.parse(JSON.stringify(t.edges)),V()}}function Ee(){if(!f.value){m.warning("请先选择一个节点");return}const t=f.value;t.y-=50,V()}function De(){if(!f.value){m.warning("请先选择一个节点");return}const t=f.value;t.y+=50,V()}function Re(){A.value<2&&(A.value+=.1,re())}function Ue(){A.value>.5&&(A.value-=.1,re())}function ze(){A.value=1,re()}function re(){le.value&&le.value.setAttribute("transform",`scale(${A.value})`)}async function ve(){if(!Y.isNew)try{let t;Y.isShared&&Y.sharedMindmap?t=Y.sharedMindmap:Y.isShared?t=(await L.getShared(pe)).data:t=(await L.get(pe)).data,y.value=t,t.data&&t.data.nodes&&(v.value=t.data.nodes,C.value=t.data.edges||[],Array.isArray(v.value)&&v.value.length>0?T=Math.max(...v.value.map(e=>e.id))+1:T=1),await ge()}catch(t){console.error("Load mindmap error:",t)}}async function ge(){if(y.value.id)try{const t=await L.getVersions(y.value.id);console.log("加载版本历史结果:",t),ne.value=t.code===200&&Array.isArray(t.data)?t.data:[]}catch(t){console.error("Load versions error:",t),ne.value=[]}}async function Le(t){try{await L.rollbackVersion(y.value.id,t.id),await ve(),m.success("版本回滚成功"),K.value=!1}catch(e){console.error("Rollback version error:",e),m.error("版本回滚失败")}}function V(){Ve(),H.value="正在保存...",setTimeout(()=>{F(!0)},2e3)}async function F(t=!1){var e,i,c;try{if(!localStorage.getItem("token")){H.value="保存失败",t||m.error("请先登录"),me.push("/login");return}const u={title:y.value.title||"新脑图",data:{nodes:JSON.parse(JSON.stringify(v.value)),edges:JSON.parse(JSON.stringify(C.value))},is_public:y.value.is_public};if(console.log("【保存脑图-完整请求数据】:",JSON.stringify(u,null,2)),!u.title){console.error("【保存失败】脑图标题不能为空"),t||m.error("脑图标题不能为空");return}if(y.value.id)console.log("【更新脑图】ID:",y.value.id),await L.update(y.value.id,u);else{console.log("【创建新脑图】");const r=await L.create(u);console.log("【创建成功】响应:",r),y.value.id=r.data.id,y.value.title=r.data.title}y.value.id&&await ge(),H.value="已保存",t||m.success("保存成功")}catch(d){console.error("【保存失败-详细错误】:",{status:(e=d.response)==null?void 0:e.status,data:(i=d.response)==null?void 0:i.data,requestData:(c=d.config)==null?void 0:c.data}),H.value="保存失败",d.response&&d.response.status===401?(localStorage.removeItem("token"),localStorage.removeItem("user"),t||m.error("登录已过期，请重新登录"),me.push("/login")):t||m.error("保存失败")}}function W(t){const e=v.value.find(i=>i.id===t);return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:0,y:0}}function Pe(){let t=f.value;t||(t=v.value.find(N=>N.parentId===null),t||(t={id:T++,text:"中心主题",x:400,y:100,width:120,height:40,parentId:null},v.value.push(t)));const e=v.value.filter(N=>N.parentId===t.id),i=e.length,c=60,d=180;let u=t.y-i*c/2;i>0&&(u=e[e.length-1].y+c);const r={id:T++,text:"新节点",x:t.x+d,y:u,width:100,height:40,parentId:t.id};v.value.push(r),C.value.push({from:t.id,to:r.id}),V()}function Te(){if(!f.value){m.warning("请先选择一个节点");return}const t=f.value.id;function e(c){const d=[];return v.value.filter(r=>r.parentId===c).forEach(r=>{d.push(r.id),d.push(...e(r.id))}),d}const i=[t,...e(t)];v.value=v.value.filter(c=>!i.includes(c.id)),C.value=C.value.filter(c=>!i.includes(c.from)&&!i.includes(c.to)),f.value=null,V()}function $e(t,e){f.value=t,Q=!0,Z=t;const i=oe.value.getBoundingClientRect();ie={x:e.clientX-i.left-t.x*A.value,y:e.clientY-i.top-t.y*A.value}}function Be(t){f.value=t,B.value=t.text}function Ye(){if(f.value){f.value.text=B.value;const t=B.value.length;f.value.width=Math.max(100,t*10),V()}}function Fe(){f.value&&(f.value.fontSize=M.value.fontSize,f.value.fontColor=M.value.fontColor,f.value.bgColor=M.value.bgColor,V())}function je(){f.value&&(B.value=f.value.text,ye())}function ye(){f.value&&(M.value.fontSize=f.value.fontSize||14,M.value.fontColor=f.value.fontColor||"#333",M.value.bgColor=f.value.bgColor||"#fff")}ke(f,t=>{t&&(B.value=t.text,ye())},{immediate:!0});function He(t){t.target.tagName==="svg"&&(f.value=null)}function xe(t){if(!Q||!Z)return;const e=oe.value.getBoundingClientRect();Z.x=(t.clientX-e.left-ie.x)/A.value,Z.y=(t.clientY-e.top-ie.y)/A.value}function _e(){Q&&(Q=!1,Z=null,V())}it(()=>{Oe.initFromStorage(),ve(),document.addEventListener("mousemove",xe),document.addEventListener("mouseup",_e)});async function Ze(){if(!y.value.id){m.error("请先保存脑图");return}ae.value=!0,await de()}async function qe(){if(!y.value.id){m.error("请先保存脑图");return}try{const t=await L.share(y.value.id,{permission:P.value.permission,expire_at:P.value.expire_at});m.success("分享链接创建成功"),await de(),P.value={permission:"view",expire_at:""}}catch(t){console.error("创建分享链接失败:",t),m.error("创建分享链接失败")}}async function de(){if(y.value.id)try{const t=await L.getShares(y.value.id);he.value=t}catch(t){console.error("加载分享链接失败:",t),m.error("加载分享链接失败")}}async function Ge(t){try{await L.deleteShare(t),m.success("分享链接已删除"),await de()}catch(e){console.error("删除分享链接失败:",e),m.error("删除分享链接失败")}}function ue(t){return window.location.origin+t}async function Xe(t){const e=ue(t);try{await navigator.clipboard.writeText(e),m.success("分享链接已复制到剪贴板")}catch(i){console.error("复制失败:",i),m.error("复制失败，请手动复制")}}function Ke(t){const e=[],i=[];let c=1;if(t.includes("中国特色社会主义")){const d={id:c++,text:"中国特色社会主义",x:400,y:100,width:180,height:40,parentId:null};e.push(d);const u=[{text:"指导思想",x:150,y:200},{text:"基本路线",x:300,y:200},{text:"经济",x:450,y:200},{text:"政治",x:600,y:200},{text:"文化",x:225,y:400},{text:"社会",x:400,y:400},{text:"生态文明",x:575,y:400}],r=[];for(let s=0;s<u.length;s++){const h={id:c++,text:u[s].text,x:u[s].x,y:u[s].y,width:120,height:40,parentId:d.id};e.push(h),r.push(h),i.push({from:d.id,to:h.id})}const N=["马克思列宁主义","毛泽东思想","邓小平理论","三个代表","科学发展观","习近平新时代中国特色社会主义思想"];for(let s=0;s<N.length;s++){const h={id:c++,text:N[s],x:100+s%2*150,y:300+Math.floor(s/2)*80,width:150,height:40,parentId:r[0].id};e.push(h),i.push({from:r[0].id,to:h.id})}const J=["以经济建设为中心","坚持四项基本原则","坚持改革开放"];for(let s=0;s<J.length;s++){const h={id:c++,text:J[s],x:250+s*150,y:300,width:150,height:40,parentId:r[1].id};e.push(h),i.push({from:r[1].id,to:h.id})}const O=["社会主义市场经济","公有制为主体","多种所有制共同发展","高质量发展"];for(let s=0;s<O.length;s++){const h={id:c++,text:O[s],x:400+s%2*150,y:300+Math.floor(s/2)*80,width:150,height:40,parentId:r[2].id};e.push(h),i.push({from:r[2].id,to:h.id})}const p=["党的领导","人民民主","法治","社会主义民主政治"];for(let s=0;s<p.length;s++){const h={id:c++,text:p[s],x:550+s%2*150,y:300+Math.floor(s/2)*80,width:150,height:40,parentId:r[3].id};e.push(h),i.push({from:r[3].id,to:h.id})}const k=["社会主义核心价值观","中华优秀传统文化","文化自信","文化软实力"];for(let s=0;s<k.length;s++){const h={id:c++,text:k[s],x:150+s%2*150,y:500+Math.floor(s/2)*80,width:150,height:40,parentId:r[4].id};e.push(h),i.push({from:r[4].id,to:h.id})}const ee=["共同富裕","社会公平正义","教育医疗住房","社会保障体系"];for(let s=0;s<ee.length;s++){const h={id:c++,text:ee[s],x:350+s%2*150,y:500+Math.floor(s/2)*80,width:150,height:40,parentId:r[5].id};e.push(h),i.push({from:r[5].id,to:h.id})}const te=["绿水青山就是金山银山","可持续发展","环境保护","绿色发展"];for(let s=0;s<te.length;s++){const h={id:c++,text:te[s],x:550+s%2*150,y:500+Math.floor(s/2)*80,width:150,height:40,parentId:r[6].id};e.push(h),i.push({from:r[6].id,to:h.id})}return{nodes:e,edges:i}}else{const d=["基础课程","核心课程","选修课程"],u=["编程基础","数据结构","算法","计算机组成原理","操作系统"],r=["数据库","计算机网络","软件工程","人工智能","计算机图形学"],N=["编译原理","计算机安全","机器学习","深度学习","自然语言处理","计算机视觉","分布式系统","嵌入式系统","移动应用开发","云计算","大数据处理"],J={id:c++,text:"计算机专业课程",x:400,y:100,width:150,height:40,parentId:null};e.push(J);const O=[];for(let p=0;p<d.length;p++){const k={id:c++,text:d[p],x:200+p*250,y:200,width:120,height:40,parentId:J.id};e.push(k),O.push(k),i.push({from:J.id,to:k.id})}for(let p=0;p<u.length;p++){const k={id:c++,text:u[p],x:150+p%2*150,y:300+Math.floor(p/2)*100,width:120,height:40,parentId:O[0].id};e.push(k),i.push({from:O[0].id,to:k.id})}for(let p=0;p<r.length;p++){const k={id:c++,text:r[p],x:400+p%2*150,y:300+Math.floor(p/2)*100,width:120,height:40,parentId:O[1].id};e.push(k),i.push({from:O[1].id,to:k.id})}for(let p=0;p<N.length;p++){const k={id:c++,text:N[p],x:650+p%2*150,y:300+Math.floor(p/2)*100,width:120,height:40,parentId:O[2].id};e.push(k),i.push({from:O[2].id,to:k.id})}return{nodes:e,edges:i}}}return rt(()=>{document.removeEventListener("mousemove",xe),document.removeEventListener("mouseup",_e)}),(t,e)=>{const i=w("el-input"),c=w("Plus"),d=w("el-tooltip"),u=w("Top"),r=w("Bottom"),N=w("el-divider"),J=w("RefreshLeft"),O=w("RefreshRight"),p=w("ZoomIn"),k=w("ZoomOut"),ee=w("Refresh"),te=w("el-input-number"),s=w("el-color-picker"),h=w("el-switch"),Qe=w("el-card"),We=w("el-timeline-item"),et=w("el-timeline"),tt=w("el-drawer");return S(),U("div",wt,[o(Qe,{class:"mindmap-editor"},{header:l(()=>[x("div",St,[x("div",Nt,[o(n(_),{link:"",onClick:e[0]||(e[0]=a=>t.$router.push("/mindmaps"))},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(dt))]),_:1}),e[12]||(e[12]=$(" 返回 ",-1))]),_:1}),o(i,{modelValue:y.value.title,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value.title=a),placeholder:"请输入脑图标题",style:{width:"300px","margin-left":"20px"},onInput:V},null,8,["modelValue"])]),x("div",kt,[x("div",It,[!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:0,content:"添加子节点",placement:"top"},{default:l(()=>[o(n(_),{onClick:Pe},{default:l(()=>[o(n(b),null,{default:l(()=>[o(c)]),_:1})]),_:1})]),_:1})):E("",!0),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:1,content:"删除节点",placement:"top"},{default:l(()=>[o(n(_),{onClick:Te},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(Ie))]),_:1})]),_:1})]),_:1})):E("",!0),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:2,content:"节点上移",placement:"top"},{default:l(()=>[o(n(_),{onClick:Ee},{default:l(()=>[o(n(b),null,{default:l(()=>[o(u)]),_:1})]),_:1})]),_:1})):E("",!0),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:3,content:"节点下移",placement:"top"},{default:l(()=>[o(n(_),{onClick:De},{default:l(()=>[o(n(b),null,{default:l(()=>[o(r)]),_:1})]),_:1})]),_:1})):E("",!0),o(N,{direction:"vertical"}),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:4,content:"撤销",placement:"top"},{default:l(()=>[o(n(_),{onClick:Ae},{default:l(()=>[o(n(b),null,{default:l(()=>[o(J)]),_:1})]),_:1})]),_:1})):E("",!0),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:5,content:"重做",placement:"top"},{default:l(()=>[o(n(_),{onClick:Je},{default:l(()=>[o(n(b),null,{default:l(()=>[o(O)]),_:1})]),_:1})]),_:1})):E("",!0),o(N,{direction:"vertical"}),o(d,{content:"放大",placement:"top"},{default:l(()=>[o(n(_),{onClick:Re},{default:l(()=>[o(n(b),null,{default:l(()=>[o(p)]),_:1})]),_:1})]),_:1}),o(d,{content:"缩小",placement:"top"},{default:l(()=>[o(n(_),{onClick:Ue},{default:l(()=>[o(n(b),null,{default:l(()=>[o(k)]),_:1})]),_:1})]),_:1}),o(d,{content:"重置缩放",placement:"top"},{default:l(()=>[o(n(_),{onClick:ze},{default:l(()=>[o(n(b),null,{default:l(()=>[o(ee)]),_:1})]),_:1})]),_:1}),o(N,{direction:"vertical"}),g.isShared?E("",!0):(S(),z(d,{key:6,content:"分享",placement:"top"},{default:l(()=>[o(n(_),{onClick:Ze},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(ut))]),_:1})]),_:1})]),_:1})),o(N,{direction:"vertical"}),o(_t),o(N,{direction:"vertical"}),o(d,{content:"版本历史",placement:"top"},{default:l(()=>[o(n(_),{onClick:e[2]||(e[2]=a=>K.value=!0)},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(ct))]),_:1})]),_:1})]),_:1}),!g.isShared||g.sharePermission==="edit"?(S(),z(d,{key:7,content:"保存",placement:"top"},{default:l(()=>[o(n(_),{type:"primary",onClick:F},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(ft))]),_:1})]),_:1})]),_:1})):E("",!0)])])])]),default:l(()=>[x("div",bt,[(S(),U("svg",{ref_key:"svgRef",ref:oe,class:"mindmap-svg",onMousedown:He},[x("g",{ref_key:"zoomGroupRef",ref:le},[(S(!0),U(ce,null,fe(C.value,a=>(S(),U("line",{key:`${a.from}-${a.to}`,x1:W(a.from).x,y1:W(a.from).y,x2:W(a.to).x,y2:W(a.to).y,stroke:"#999","stroke-width":"2"},null,8,Ct))),128)),(S(!0),U(ce,null,fe(v.value,a=>{var q,we,Se;return S(),U("g",{key:a.id,transform:`translate(${a.x}, ${a.y})`,class:"node-group",onMousedown:xt(Ne=>!g.isShared||g.sharePermission==="edit"?$e(a,Ne):null,["stop"]),onDblclick:Ne=>!g.isShared||g.sharePermission==="edit"?Be(a):null},[x("rect",{width:a.width,height:a.height,fill:((q=f.value)==null?void 0:q.id)===a.id?"#409eff":a.bgColor||"#fff",stroke:((we=f.value)==null?void 0:we.id)===a.id?"#409eff":"#333","stroke-width":"2",rx:"5"},null,8,Ot),x("text",{x:a.width/2,y:a.height/2,"text-anchor":"middle","dominant-baseline":"middle",fill:((Se=f.value)==null?void 0:Se.id)===a.id?"#fff":a.fontColor||"#333","font-size":a.fontSize||14},j(a.text),9,Vt)],40,Mt)}),128))],512)],544)),f.value&&(!g.isShared||g.sharePermission==="edit")?(S(),U("div",At,[e[16]||(e[16]=x("h4",null,"编辑节点",-1)),o(i,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),placeholder:"输入节点文本",type:"textarea",rows:3,style:{"margin-bottom":"10px"}},null,8,["modelValue"]),x("div",Jt,[o(n(_),{type:"primary",onClick:Ye},{default:l(()=>[...e[13]||(e[13]=[$("保存",-1)])]),_:1}),o(n(_),{onClick:je},{default:l(()=>[...e[14]||(e[14]=[$("取消",-1)])]),_:1})]),e[17]||(e[17]=x("h4",{style:{"margin-top":"20px"}},"文字样式",-1)),o(n(be),{model:M.value,"label-width":"80px"},{default:l(()=>[o(n(G),{label:"字体大小"},{default:l(()=>[o(te,{modelValue:M.value.fontSize,"onUpdate:modelValue":e[4]||(e[4]=a=>M.value.fontSize=a),min:12,max:36,step:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),o(n(G),{label:"字体颜色"},{default:l(()=>[o(s,{modelValue:M.value.fontColor,"onUpdate:modelValue":e[5]||(e[5]=a=>M.value.fontColor=a),"show-alpha":""},null,8,["modelValue"])]),_:1}),o(n(G),{label:"背景颜色"},{default:l(()=>[o(s,{modelValue:M.value.bgColor,"onUpdate:modelValue":e[6]||(e[6]=a=>M.value.bgColor=a),"show-alpha":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),x("div",Et,[o(n(_),{type:"primary",onClick:Fe},{default:l(()=>[...e[15]||(e[15]=[$("应用样式",-1)])]),_:1})])])):E("",!0)]),g.isShared?E("",!0):(S(),U("div",Dt,[x("span",Rt,j(H.value),1),o(h,{modelValue:y.value.is_public,"onUpdate:modelValue":e[7]||(e[7]=a=>y.value.is_public=a),"active-text":"公开","inactive-text":"私有",onChange:V},null,8,["modelValue"])]))]),_:1}),o(n(yt),{modelValue:ae.value,"onUpdate:modelValue":e[10]||(e[10]=a=>ae.value=a),title:"分享脑图",width:"600px"},{default:l(()=>[x("div",null,[e[19]||(e[19]=x("h4",null,"创建新分享链接",-1)),o(n(be),{model:P.value,"label-width":"100px",style:{"margin-bottom":"20px"}},{default:l(()=>[o(n(G),{label:"权限"},{default:l(()=>[o(n(mt),{modelValue:P.value.permission,"onUpdate:modelValue":e[8]||(e[8]=a=>P.value.permission=a),placeholder:"请选择权限",style:{width:"200px"}},{default:l(()=>[o(n(Ce),{label:"只读",value:"view"}),o(n(Ce),{label:"可编辑",value:"edit"})]),_:1},8,["modelValue"])]),_:1}),o(n(G),{label:"过期时间"},{default:l(()=>[o(n(pt),{modelValue:P.value.expire_at,"onUpdate:modelValue":e[9]||(e[9]=a=>P.value.expire_at=a),type:"datetime",placeholder:"选择过期时间",style:{width:"200px"},format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),o(n(_),{type:"primary",onClick:qe},{default:l(()=>[...e[18]||(e[18]=[$("创建分享链接",-1)])]),_:1}),e[20]||(e[20]=x("h4",{style:{"margin-top":"30px"}},"已创建的分享链接",-1)),o(n(ht),{data:he.value,style:{width:"100%"}},{default:l(()=>[o(n(X),{prop:"share_url",label:"分享链接","min-width":"250"},{default:l(a=>[x("div",Ut,[x("a",{href:ue(a.row.share_url),target:"_blank",style:{flex:"1",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},j(ue(a.row.share_url)),9,zt),o(n(_),{size:"small",onClick:q=>Xe(a.row.share_url)},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(vt))]),_:1})]),_:1},8,["onClick"])])]),_:1}),o(n(X),{prop:"permission",label:"权限",width:"100"},{default:l(a=>[o(n(gt),{type:a.row.permission==="view"?"info":"success"},{default:l(()=>[$(j(a.row.permission==="view"?"只读":"可编辑"),1)]),_:2},1032,["type"])]),_:1}),o(n(X),{prop:"expire_at",label:"过期时间",width:"180"},{default:l(a=>[$(j(a.row.expire_at||"永不过期"),1)]),_:1}),o(n(X),{prop:"created_at",label:"创建时间",width:"180"}),o(n(X),{label:"操作",width:"100"},{default:l(a=>[o(n(_),{type:"danger",size:"small",onClick:q=>Ge(a.row.token)},{default:l(()=>[o(n(b),null,{default:l(()=>[o(n(Ie))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),o(tt,{modelValue:K.value,"onUpdate:modelValue":e[11]||(e[11]=a=>K.value=a),title:"版本历史",size:"40%"},{default:l(()=>[o(et,null,{default:l(()=>[(S(!0),U(ce,null,fe(ne.value,a=>(S(),z(We,{key:a.id,timestamp:a.updated_at,placement:"top"},{default:l(()=>[x("div",Lt,[x("div",Pt,"版本: "+j(a.id),1),x("div",Tt,[o(n(_),{link:"",type:"warning",onClick:q=>Le(a)},{default:l(()=>[...e[21]||(e[21]=[$(" 回滚 ",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1},8,["modelValue"])])}}},Zt=ot(Bt,[["__scopeId","data-v-052354e4"]]);export{Zt as default};
