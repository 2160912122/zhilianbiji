import{_ as N,u as P,a as V,o as D,r,b as m,c as S,e as a,d as s,w as e,F as v,n as F,G as T,f as u,A as p,m as w,H as U,I as z,g as q}from"./index-7d284294.js";const H={class:"dashboard"},M={class:"page-header"},j={class:"header-content"},J={class:"header-actions"},K={class:"stat-content no-scrollbar"},O={class:"stat-info"},Q={class:"stat-value"},W={class:"stat-content no-scrollbar"},X={class:"stat-info"},Y={class:"stat-value"},Z={class:"stat-content no-scrollbar"},tt={class:"stat-info"},st={class:"stat-value"},et={class:"stat-content no-scrollbar"},at={class:"stat-info"},ot={class:"stat-value"},lt={class:"stat-content no-scrollbar"},nt={class:"stat-info"},rt={class:"stat-value"},it={class:"quick-actions"},dt={__name:"Dashboard",setup(ct){P();const y=V();D(async()=>{if(localStorage.getItem("token")&&!y.user)try{await y.fetchCurrentUser(),console.log("用户信息加载成功：",y.user)}catch(o){console.warn("用户信息加载失败：",o),localStorage.removeItem("token"),window.location.href="/login"}});const f=q({notes:0,tables:0,whiteboards:0,mindmaps:0,flowcharts:0}),b=q([]);async function h(){try{const[o,t,n,i,_]=await Promise.all([v.get("/api/notes"),v.get("/api/tables"),v.get("/api/whiteboards"),v.get("/api/mindmaps"),v.get("/api/flowcharts")]);f.value={notes:Array.isArray(o)?o.length:0,tables:Array.isArray(t)?t.length:0,whiteboards:Array.isArray(n)?n.length:0,mindmaps:Array.isArray(i)?i.length:0,flowcharts:Array.isArray(_)?_.length:0},b.value=[...(Array.isArray(o)?o.slice(0,2):[]).map(l=>({...l,type:"note"})),...(Array.isArray(t)?t.slice(0,2):[]).map(l=>({...l,type:"table"})),...(Array.isArray(n)?n.slice(0,2):[]).map(l=>({...l,type:"whiteboard"})),...(Array.isArray(i)?i.slice(0,2):[]).map(l=>({...l,type:"mindmap"})),...(Array.isArray(_)?_.slice(0,2):[]).map(l=>({...l,type:"flowchart"}))].sort((l,c)=>new Date(c.updated_at||0)-new Date(l.updated_at||0)).slice(0,5)}catch(o){console.error("加载数据失败:",o)}}function R(o){return{note:`/notes/${o.id}`,table:`/tables/${o.id}`,whiteboard:`/whiteboards/${o.id}`,mindmap:`/mindmaps/${o.id}`,flowchart:`/flowcharts/${o.id}`}[o.type]||"#"}function I(o){return{note:"笔记",table:"表格",whiteboard:"白板",mindmap:"脑图",flowchart:"流程图"}[o]||o}return D(()=>{h()}),(o,t)=>{const n=r("el-icon"),i=r("el-button"),_=r("Document"),l=r("el-card"),c=r("el-col"),g=r("Grid"),k=r("EditPen"),A=r("Connection"),$=r("Share"),C=r("el-row"),B=r("el-empty"),x=r("el-link"),E=r("el-tag"),G=r("el-timeline-item"),L=r("el-timeline");return m(),S("div",H,[a("div",M,[a("div",j,[t[7]||(t[7]=a("h1",{class:"page-title"},"仪表盘",-1)),a("div",J,[t[6]||(t[6]=a("p",{class:"page-desc"},"欢迎回来，这里是您的个人数据概览",-1)),s(i,{type:"primary",onClick:h},{default:e(()=>[s(n,null,{default:e(()=>[s(F(T))]),_:1}),t[5]||(t[5]=u(" 刷新数据 ",-1))]),_:1})])])]),s(C,{gutter:20},{default:e(()=>[s(c,{span:4},{default:e(()=>[s(l,{class:"stat-card no-scrollbar"},{default:e(()=>[a("div",K,[s(n,{class:"stat-icon",color:"#409eff"},{default:e(()=>[s(_)]),_:1}),a("div",O,[a("div",Q,p(f.value.notes||0),1),t[8]||(t[8]=a("div",{class:"stat-label"},"我的笔记总数",-1))])])]),_:1})]),_:1}),s(c,{span:4},{default:e(()=>[s(l,{class:"stat-card no-scrollbar"},{default:e(()=>[a("div",W,[s(n,{class:"stat-icon",color:"#67c23a"},{default:e(()=>[s(g)]),_:1}),a("div",X,[a("div",Y,p(f.value.tables||0),1),t[9]||(t[9]=a("div",{class:"stat-label"},"我的表格总数",-1))])])]),_:1})]),_:1}),s(c,{span:4},{default:e(()=>[s(l,{class:"stat-card no-scrollbar"},{default:e(()=>[a("div",Z,[s(n,{class:"stat-icon",color:"#e6a23c"},{default:e(()=>[s(k)]),_:1}),a("div",tt,[a("div",st,p(f.value.whiteboards||0),1),t[10]||(t[10]=a("div",{class:"stat-label"},"我的白板总数",-1))])])]),_:1})]),_:1}),s(c,{span:4},{default:e(()=>[s(l,{class:"stat-card no-scrollbar"},{default:e(()=>[a("div",et,[s(n,{class:"stat-icon",color:"#f56c6c"},{default:e(()=>[s(A)]),_:1}),a("div",at,[a("div",ot,p(f.value.mindmaps||0),1),t[11]||(t[11]=a("div",{class:"stat-label"},"我的脑图总数",-1))])])]),_:1})]),_:1}),s(c,{span:4},{default:e(()=>[s(l,{class:"stat-card no-scrollbar"},{default:e(()=>[a("div",lt,[s(n,{class:"stat-icon",color:"#909399"},{default:e(()=>[s($)]),_:1}),a("div",nt,[a("div",rt,p(f.value.flowcharts||0),1),t[12]||(t[12]=a("div",{class:"stat-label"},"我的流程图总数",-1))])])]),_:1})]),_:1})]),_:1}),s(C,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[s(c,{span:12},{default:e(()=>[s(l,null,{header:e(()=>[...t[13]||(t[13]=[a("div",{class:"card-header"},[a("span",null,"快速创建")],-1)])]),default:e(()=>[a("div",it,[s(i,{type:"primary",onClick:t[0]||(t[0]=d=>o.$router.push("/notes/new")),class:"quick-action-btn"},{default:e(()=>[s(n,null,{default:e(()=>[s(_)]),_:1}),t[14]||(t[14]=u(" 新建笔记 ",-1))]),_:1}),s(i,{type:"success",onClick:t[1]||(t[1]=d=>o.$router.push("/tables/new")),class:"quick-action-btn"},{default:e(()=>[s(n,null,{default:e(()=>[s(g)]),_:1}),t[15]||(t[15]=u(" 新建表格 ",-1))]),_:1}),s(i,{type:"warning",onClick:t[2]||(t[2]=d=>o.$router.push("/whiteboards/new")),class:"quick-action-btn"},{default:e(()=>[s(n,null,{default:e(()=>[s(k)]),_:1}),t[16]||(t[16]=u(" 新建白板 ",-1))]),_:1}),s(i,{type:"danger",onClick:t[3]||(t[3]=d=>o.$router.push("/mindmaps/new")),class:"quick-action-btn"},{default:e(()=>[s(n,null,{default:e(()=>[s(A)]),_:1}),t[17]||(t[17]=u(" 新建脑图 ",-1))]),_:1}),s(i,{type:"info",onClick:t[4]||(t[4]=d=>o.$router.push("/flowcharts/new")),class:"quick-action-btn"},{default:e(()=>[s(n,null,{default:e(()=>[s($)]),_:1}),t[18]||(t[18]=u(" 新建流程图 ",-1))]),_:1})])]),_:1})]),_:1}),s(c,{span:12},{default:e(()=>[s(l,null,{header:e(()=>[...t[19]||(t[19]=[a("div",{class:"card-header"},[a("span",null,"最近更新")],-1)])]),default:e(()=>[b.value.length===0?(m(),w(B,{key:0,description:"暂无内容"})):(m(),w(L,{key:1},{default:e(()=>[(m(!0),S(U,null,z(b.value,d=>(m(),w(G,{key:d.id,timestamp:d.updated_at,placement:"top"},{default:e(()=>[s(x,{href:R(d),type:"primary"},{default:e(()=>[u(p(d.title),1)]),_:2},1032,["href"]),s(E,{size:"small",style:{"margin-left":"10px"}},{default:e(()=>[u(p(I(d.type)),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1}))]),_:1})]),_:1})]),_:1})])}}},_t=N(dt,[["__scopeId","data-v-42a149c8"]]);export{_t as default};
