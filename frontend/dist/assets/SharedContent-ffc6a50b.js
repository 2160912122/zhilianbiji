import{_ as I,k as M,u as N,o as S,r as d,b as r,c as p,m as v,w as s,d as a,g as o,f as C}from"./index-7d284294.js";import T from"./NoteEditor-1e37a54a.js";import R from"./FlowchartEditor-9e76cab9.js";import V from"./MindmapEditor-a77f9b3a.js";import"./note-65ed446a.js";import"./common-1e801628.js";import"./AIModuleButton-b5ba9e39.js";import"./editor-e9eb6766.js";const j={class:"shared-content"},D={key:2,class:"shared-note"},F={key:3,class:"shared-flowchart"},H={key:4,class:"shared-mindmap"},P={__name:"SharedContent",setup($){const E=M(),B=N(),m=o(!0),f=o(!1),y=o("error"),w=o(""),x=o(""),l=o(""),n=o(null),u=o("view"),c=o(null);S(async()=>{const i=E.params.token;if(!i){_("error","无效的分享链接","缺少分享令牌");return}try{const t=await fetch(`/api/share/${i}`),e=await t.json();if(!t.ok){_("error","分享链接无效",e.message||"无法访问分享的内容");return}c.value=e,l.value=e.type,e.type==="note"?n.value=e.note.id:e.type==="flowchart"?n.value=e.flowchart.id:e.type==="mindmap"&&(n.value=e.mindmap.id),u.value=e.permission||"view",m.value=!1}catch(t){console.error("加载分享内容失败:",t),_("error","加载失败","无法加载分享内容，请稍后重试")}});function _(i,t,e){y.value=i,w.value=t,x.value=e,f.value=!0,m.value=!1}function k(){B.push("/login")}return(i,t)=>{const e=d("el-empty"),h=d("el-card"),g=d("el-button"),b=d("el-result");return r(),p("div",j,[m.value?(r(),v(h,{key:0,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[a(e,{description:"加载中..."})]),_:1})):f.value?(r(),v(h,{key:1,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[a(b,{icon:y.value,title:w.value,"sub-title":x.value},{extra:s(()=>[a(g,{type:"primary",onClick:k},{default:s(()=>[...t[0]||(t[0]=[C("返回首页",-1)])]),_:1})]),_:1},8,["icon","title","sub-title"])]),_:1})):l.value==="note"?(r(),p("div",D,[a(T,{"note-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-note":c.value.note},null,8,["note-id","share-permission","shared-note"])])):l.value==="flowchart"?(r(),p("div",F,[a(R,{"flowchart-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-flowchart":c.value.flowchart},null,8,["flowchart-id","share-permission","shared-flowchart"])])):l.value==="mindmap"?(r(),p("div",H,[a(V,{"mindmap-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-mindmap":c.value.mindmap},null,8,["mindmap-id","share-permission","shared-mindmap"])])):(r(),v(h,{key:5,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[a(b,{icon:"warning",title:"不支持的分享类型","sub-title":"该分享链接指向的内容类型不支持"},{extra:s(()=>[a(g,{type:"primary",onClick:k},{default:s(()=>[...t[1]||(t[1]=[C("返回首页",-1)])]),_:1})]),_:1})]),_:1}))])}}},Q=I(P,[["__scopeId","data-v-cb6269bd"]]);export{Q as default};
