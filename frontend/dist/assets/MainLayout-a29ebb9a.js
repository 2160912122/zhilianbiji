import{_ as D,k as h,u as q,a as F,l as m,o as U,r as o,b as _,m as f,w as t,d as e,e as s,n as l,p as j,q as G,s as H,t as J,v as K,x as O,y as P,f as i,z as Q,A as v,c as W,B as X,C as Y,D as Z,E as y}from"./index-86929dc7.js";const $={class:"header-left"},ee={class:"page-title"},te={class:"header-right"},ne={class:"user-info"},oe={__name:"MainLayout",setup(se){const p=h(),c=q(),d=F(),b=m(()=>{var a;const r=d.is_admin===1||((a=d.user)==null?void 0:a.is_admin)===1,n=localStorage.getItem("is_admin")==="1";return r||n}),k=m(()=>p.path),B=m(()=>({"/dashboard":"仪表盘","/notes":"笔记管理","/tables":"表格管理","/whiteboards":"白板管理","/mindmaps":"脑图管理","/flowcharts":"流程图管理","/categories":"分类管理","/tags":"标签管理","/admin":"工作台"})[p.path]||"智联笔记"),C=()=>{c.push("/login")};async function M(r){if(r==="logout")try{await Z.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await d.logout(),localStorage.removeItem("isAdmin"),y.success("已退出登录"),c.push("/login")}catch{y.info("已取消退出")}}return U(()=>{d.initFromStorage()}),(r,n)=>{const a=o("el-icon"),u=o("el-menu-item"),S=o("el-sub-menu"),A=o("el-menu"),I=o("el-aside"),E=o("el-button"),L=o("el-dropdown-item"),N=o("el-dropdown-menu"),T=o("el-dropdown"),V=o("el-header"),R=o("router-view"),z=o("el-main"),g=o("el-container");return _(),f(g,{class:"main-layout"},{default:t(()=>[e(I,{width:"200px",class:"sidebar"},{default:t(()=>[n[11]||(n[11]=s("div",{class:"logo"},[s("h2",null,"智联笔记")],-1)),e(A,{"default-active":k.value,router:"",class:"menu"},{default:t(()=>[e(u,{index:"/dashboard"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(j))]),_:1}),n[0]||(n[0]=s("span",null,"仪表盘",-1))]),_:1}),e(u,{index:"/notes"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(G))]),_:1}),n[1]||(n[1]=s("span",null,"笔记",-1))]),_:1}),e(u,{index:"/tables"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(H))]),_:1}),n[2]||(n[2]=s("span",null,"表格",-1))]),_:1}),e(u,{index:"/whiteboards"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(J))]),_:1}),n[3]||(n[3]=s("span",null,"白板",-1))]),_:1}),e(u,{index:"/mindmaps"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(K))]),_:1}),n[4]||(n[4]=s("span",null,"脑图",-1))]),_:1}),e(u,{index:"/flowcharts"},{default:t(()=>[e(a,null,{default:t(()=>[e(l(O))]),_:1}),n[5]||(n[5]=s("span",null,"流程图",-1))]),_:1}),b.value?(_(),f(S,{key:0,index:"manage"},{title:t(()=>[e(a,null,{default:t(()=>[e(l(P))]),_:1}),n[6]||(n[6]=s("span",null,"管理",-1))]),default:t(()=>[e(u,{index:"/categories"},{default:t(()=>[...n[7]||(n[7]=[i("分类",-1)])]),_:1}),e(u,{index:"/tags"},{default:t(()=>[...n[8]||(n[8]=[i("标签",-1)])]),_:1}),e(u,{index:"/admin"},{default:t(()=>[...n[9]||(n[9]=[i("工作台",-1)])]),_:1}),e(u,{index:"/admin/user-manage"},{default:t(()=>[...n[10]||(n[10]=[i("用户管理",-1)])]),_:1})]),_:1})):Q("",!0)]),_:1},8,["default-active"])]),_:1}),e(g,null,{default:t(()=>[e(V,{class:"header"},{default:t(()=>[s("div",$,[s("span",ee,v(B.value),1)]),s("div",te,[l(d).user?(_(),f(T,{key:1,onCommand:M},{dropdown:t(()=>[e(N,null,{default:t(()=>[e(L,{command:"logout"},{default:t(()=>[...n[13]||(n[13]=[i("退出登录",-1)])]),_:1})]),_:1})]),default:t(()=>{var x,w;return[s("span",ne,[e(a,null,{default:t(()=>[e(l(X))]),_:1}),i(" "+v(((x=l(d).user)==null?void 0:x.username)||((w=l(d).user)==null?void 0:w.email))+" ",1),e(a,{class:"el-icon--right"},{default:t(()=>[e(l(Y))]),_:1})])]}),_:1})):(_(),W("div",{key:0,onClick:C,class:"login-btn"},[e(E,{type:"primary",size:"small"},{default:t(()=>[...n[12]||(n[12]=[i("登录",-1)])]),_:1})]))])]),_:1}),e(z,{class:"main-content"},{default:t(()=>[e(R)]),_:1})]),_:1})]),_:1})}}},le=D(oe,[["__scopeId","data-v-66244e07"]]);export{le as default};
