import{_ as k,u as y,a as V,o as x,E as n,r as a,b as R,c as C,d as o,w as t,e as L,f as _,g as i}from"./index-7d284294.js";const T={class:"login-container"},B={__name:"Login",setup(E){const l=y(),g=V(),u=i(null),s=i({username:"",password:""}),f=i({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),v=async()=>{if(u.value){try{await u.value.validate()}catch{n.error("请完善登录信息");return}try{const r=await g.login({username:s.value.username,password:s.value.password});n.success("登录成功！"),setTimeout(()=>{l.push("/dashboard").catch(e=>{console.log("跳转dashboard失败，兜底跳首页",e),l.push("/").catch(()=>{})})},300)}catch(r){n.error(r.message||"登录失败，请检查账号密码"),console.error("登录失败详情：",r)}}},w=()=>{l.push("/register").catch(()=>{})};return x(()=>{localStorage.getItem("token")&&(n.info("已检测到登录状态，自动跳转到首页"),setTimeout(()=>{l.push("/dashboard").catch(()=>{})},500))}),(r,e)=>{const m=a("el-input"),d=a("el-form-item"),p=a("el-button"),b=a("el-form"),h=a("el-card");return R(),C("div",T,[o(h,{class:"login-card"},{default:t(()=>[e[4]||(e[4]=L("h2",{class:"login-title"},"登录",-1)),o(b,{ref_key:"loginFormRef",ref:u,model:s.value,rules:f.value,"label-width":"80px"},{default:t(()=>[o(d,{label:"用户名",prop:"username"},{default:t(()=>[o(m,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=c=>s.value.username=c),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(d,{label:"密码",prop:"password"},{default:t(()=>[o(m,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=c=>s.value.password=c),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(p,{type:"primary",onClick:v,class:"login-btn"},{default:t(()=>[...e[2]||(e[2]=[_("登录",-1)])]),_:1}),o(p,{onClick:w,link:""},{default:t(()=>[...e[3]||(e[3]=[_("没有账号？去注册",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}},N=k(B,[["__scopeId","data-v-819483f4"]]);export{N as default};
