import{c as m}from"./common-e6801aab.js";import{_ as S,o as T,r as o,b as $,c as h,d as t,w as a,g as _,e as g,f as i,A,E as d,D as I}from"./index-911a223c.js";const U={class:"categories-page"},z={class:"card-header"},j={__name:"Categories",setup(q){const v=_([]),s=_(!1),c=_(!1),n=_({id:null,name:""});async function f(){try{v.value=await m.getList()}catch(l){console.error("Load categories error:",l)}}function y(){c.value=!1,n.value={id:null,name:""},s.value=!0}function b(l){c.value=!0,n.value={id:l.id,name:l.name},s.value=!0}async function C(){if(!n.value.name.trim()){d.warning("请输入分类名称");return}try{c.value?(await m.update(n.value.id,{name:n.value.name}),d.success("更新成功")):(await m.create({name:n.value.name}),d.success("创建成功")),s.value=!1,f()}catch(l){console.error("Submit category error:",l),d.error("操作失败")}}async function w(l){try{await I.confirm("确定要删除这个分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await m.delete(l),d.success("删除成功"),f()}catch(e){e!=="cancel"&&console.error("Delete category error:",e)}}function x(l){return l?new Date(l).toLocaleString("zh-CN"):""}return T(()=>{f()}),(l,e)=>{const k=o("Plus"),V=o("el-icon"),u=o("el-button"),p=o("el-table-column"),B=o("el-table"),D=o("el-card"),E=o("el-input"),N=o("el-form-item"),L=o("el-form"),M=o("el-dialog");return $(),h("div",U,[t(D,null,{header:a(()=>[g("div",z,[e[4]||(e[4]=g("span",null,"分类管理",-1)),t(u,{type:"primary",onClick:y},{default:a(()=>[t(V,null,{default:a(()=>[t(k)]),_:1}),e[3]||(e[3]=i(" 新建分类 ",-1))]),_:1})])]),default:a(()=>[t(B,{data:v.value,style:{width:"100%"}},{default:a(()=>[t(p,{prop:"name",label:"分类名称","min-width":"200"}),t(p,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:r})=>[i(A(x(r.created_at)),1)]),_:1}),t(p,{label:"操作",width:"150",fixed:"right"},{default:a(({row:r})=>[t(u,{link:"",type:"primary",onClick:P=>b(r)},{default:a(()=>[...e[5]||(e[5]=[i("编辑",-1)])]),_:1},8,["onClick"]),t(u,{link:"",type:"danger",onClick:P=>w(r.id)},{default:a(()=>[...e[6]||(e[6]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(M,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value=r),title:c.value?"编辑分类":"新建分类",width:"500px"},{footer:a(()=>[t(u,{onClick:e[1]||(e[1]=r=>s.value=!1)},{default:a(()=>[...e[7]||(e[7]=[i("取消",-1)])]),_:1}),t(u,{type:"primary",onClick:C},{default:a(()=>[...e[8]||(e[8]=[i("确定",-1)])]),_:1})]),default:a(()=>[t(L,{model:n.value,"label-width":"80px"},{default:a(()=>[t(N,{label:"分类名称"},{default:a(()=>[t(E,{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value.name=r),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},H=S(j,[["__scopeId","data-v-f736422b"]]);export{H as default};
