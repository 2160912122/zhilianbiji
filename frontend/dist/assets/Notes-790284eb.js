import{_ as z,u as F,o as H,r as n,b,c as C,d as a,w as l,e as m,f as r,H as Q,I as R,A as w,g as c,D as j,E as q,m as G}from"./index-911a223c.js";import{n as V}from"./note-a4b5aab6.js";import{c as J}from"./common-e6801aab.js";const K={class:"notes-page"},O={class:"card-header"},W={class:"header-buttons"},X={class:"search-bar"},Y={__name:"Notes",setup(Z){const N=F(),f=c([]),d=c([]),i=c(""),p=c(null),_=c("");let v=null;async function s(){try{const t={};i.value&&(t.search=i.value),p.value&&(t.category_id=p.value),_.value&&(t.type=_.value);const e=await V.getList(t);f.value=e.data||[]}catch(t){console.error("Load notes error:",t),f.value=[]}}async function B(){try{const t=await J.getList();d.value=t.data||[]}catch(t){console.error("Load categories error:",t),d.value=[]}}function T(){v&&clearTimeout(v),v=setTimeout(()=>{s()},300)}function L(t){N.push(`/notes/${t}`)}async function D(t){try{await j.confirm("确定要删除这条笔记吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await V.delete(t),q.success("删除成功"),s()}catch(e){e!=="cancel"&&console.error("Delete note error:",e)}}function I(t){const e=d.value.find(y=>y.id===t);return e?e.name:"未分类"}function M(t){return t?new Date(t).toLocaleString("zh-CN"):""}return H(()=>{s(),B()}),(t,e)=>{const y=n("Plus"),k=n("el-icon"),g=n("el-button"),$=n("Search"),E=n("el-input"),h=n("el-option"),x=n("el-select"),u=n("el-table-column"),P=n("el-tag"),S=n("el-table"),A=n("el-card");return b(),C("div",K,[a(A,null,{header:l(()=>[m("div",O,[e[5]||(e[5]=m("span",null,"笔记列表",-1)),m("div",W,[a(g,{type:"primary",onClick:e[0]||(e[0]=o=>t.$router.push("/notes/new"))},{default:l(()=>[a(k,null,{default:l(()=>[a(y)]),_:1}),e[4]||(e[4]=r(" 新建笔记 ",-1))]),_:1})])])]),default:l(()=>[m("div",X,[a(E,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value=o),placeholder:"搜索笔记标题或内容",clearable:"",onInput:T},{prefix:l(()=>[a(k,null,{default:l(()=>[a($)]),_:1})]),_:1},8,["modelValue"]),a(x,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=o=>p.value=o),placeholder:"选择分类",clearable:"",onChange:s},{default:l(()=>[(b(!0),C(Q,null,R(d.value,o=>(b(),G(h,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(x,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=o=>_.value=o),placeholder:"选择类型",clearable:"",onChange:s},{default:l(()=>[a(h,{label:"富文本",value:"richtext"}),a(h,{label:"Markdown",value:"markdown"})]),_:1},8,["modelValue"])]),a(S,{data:f.value,style:{width:"100%"}},{default:l(()=>[a(u,{prop:"title",label:"标题","min-width":"200"}),a(u,{prop:"type",label:"类型",width:"100"},{default:l(({row:o})=>[a(P,{type:o.type==="richtext"?"primary":"success"},{default:l(()=>[r(w(o.type==="richtext"?"富文本":"Markdown"),1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"category_id",label:"分类",width:"120"},{default:l(({row:o})=>[r(w(I(o.category_id)),1)]),_:1}),a(u,{prop:"updated_at",label:"更新时间",width:"180"},{default:l(({row:o})=>[r(w(M(o.updated_at)),1)]),_:1}),a(u,{label:"操作",width:"200",fixed:"right"},{default:l(({row:o})=>[a(g,{link:"",type:"primary",onClick:U=>L(o.id)},{default:l(()=>[...e[6]||(e[6]=[r("编辑",-1)])]),_:1},8,["onClick"]),a(g,{link:"",type:"danger",onClick:U=>D(o.id)},{default:l(()=>[...e[7]||(e[7]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}},ae=z(Y,[["__scopeId","data-v-36200c01"]]);export{ae as default};
