import{_ as I,k as M,u as N,o as S,r as m,b as a,c as p,m as v,w as s,d as r,g as o,f as C}from"./index-911a223c.js";import T from"./NoteEditor-749b8cee.js";import R from"./FlowchartEditor-9840e919.js";import V from"./MindmapEditor-9ccc35b1.js";import"./note-a4b5aab6.js";import"./common-e6801aab.js";import"./AIModuleButton-5b08fb21.js";import"./editor-cbc213f0.js";const j={class:"shared-content"},D={key:2,class:"shared-note"},F={key:3,class:"shared-flowchart"},H={key:4,class:"shared-mindmap"},P={__name:"SharedContent",setup($){const E=M(),B=N(),_=o(!0),f=o(!1),y=o("error"),w=o(""),x=o(""),l=o(""),n=o(null),u=o("view"),c=o(null);S(async()=>{const i=E.params.token;if(!i){d("error","无效的分享链接","缺少分享令牌");return}try{const t=await fetch(`/api/share/${i}`),e=await t.json();if(!t.ok){d("error","分享链接无效",e.message||"无法访问分享的内容");return}if(!e.code||e.code!==200){d("error","分享链接无效",e.message||"无法访问分享的内容");return}c.value=e,l.value=e.type,e.type==="note"?n.value=e.note.id:e.type==="flowchart"?n.value=e.flowchart.id:e.type==="mindmap"&&(n.value=e.mindmap.id),u.value=e.permission||"view",_.value=!1}catch(t){console.error("加载分享内容失败:",t),d("error","加载失败","无法加载分享内容，请稍后重试")}});function d(i,t,e){y.value=i,w.value=t,x.value=e,f.value=!0,_.value=!1}function k(){B.push("/login")}return(i,t)=>{const e=m("el-empty"),h=m("el-card"),g=m("el-button"),b=m("el-result");return a(),p("div",j,[_.value?(a(),v(h,{key:0,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[r(e,{description:"加载中..."})]),_:1})):f.value?(a(),v(h,{key:1,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[r(b,{icon:y.value,title:w.value,"sub-title":x.value},{extra:s(()=>[r(g,{type:"primary",onClick:k},{default:s(()=>[...t[0]||(t[0]=[C("返回首页",-1)])]),_:1})]),_:1},8,["icon","title","sub-title"])]),_:1})):l.value==="note"?(a(),p("div",D,[r(T,{"note-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-note":c.value.note},null,8,["note-id","share-permission","shared-note"])])):l.value==="flowchart"?(a(),p("div",F,[r(R,{"flowchart-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-flowchart":c.value.flowchart},null,8,["flowchart-id","share-permission","shared-flowchart"])])):l.value==="mindmap"?(a(),p("div",H,[r(V,{"mindmap-id":n.value,"is-shared":!0,"share-permission":u.value,"shared-mindmap":c.value.mindmap},null,8,["mindmap-id","share-permission","shared-mindmap"])])):(a(),v(h,{key:5,style:{"max-width":"600px",margin:"50px auto"}},{default:s(()=>[r(b,{icon:"warning",title:"不支持的分享类型","sub-title":"该分享链接指向的内容类型不支持"},{extra:s(()=>[r(g,{type:"primary",onClick:k},{default:s(()=>[...t[1]||(t[1]=[C("返回首页",-1)])]),_:1})]),_:1})]),_:1}))])}}},Q=I(P,[["__scopeId","data-v-9bde231c"]]);export{Q as default};
